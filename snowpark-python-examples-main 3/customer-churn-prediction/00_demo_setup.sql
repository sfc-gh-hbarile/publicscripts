-- Please visit the telco data engineering end to end demo at https://github.com/sfc-gh-pjain/telco
-- telco demo includes building a pipeline for telecom customer demographic data
-- This demo is continuation of the same but from Data science perspective to predict the customer churn

use schema demo.telco;
 

CREATE OR REPLACE VIEW CAT_FEATURE_VW
AS
SELECT D.CUSTOMERID, D.GENDER,D.SENIORCITIZEN,D.PARTNER,D.DEPENDENTS,
S.PHONESERVICE, S.MULTIPLELINES, S.INTERNETSERVICE,S.ONLINESECURITY,
S.ONLINEBACKUP, S.DEVICEPROTECTION, S.TECHSUPPORT, S.STREAMINGTV,
S.STREAMINGMOVIES ,S.CONTRACT, S.PAPERLESSBILLING, S.PAYMENTMETHOD, S.CHURNVALUE

FROM DEMOGRAPHICS D LEFT OUTER JOIN 
SERVICES S ON S.CUSTOMERID = D.CUSTOMERID;


CREATE OR REPLACE VIEW TRAIN_DATASET
AS
SELECT D.CUSTOMERID, D.GENDER,D.SENIORCITIZEN,D.PARTNER,D.DEPENDENTS,
S.PHONESERVICE, S.MULTIPLELINES, S.INTERNETSERVICE,S.ONLINESECURITY,
S.ONLINEBACKUP, S.DEVICEPROTECTION, S.TECHSUPPORT, S.STREAMINGTV,
S.STREAMINGMOVIES ,S.CONTRACT, S.PAPERLESSBILLING, S.PAYMENTMETHOD, 
S.TENUREMONTHS, S.MONTHLYCHARGES, S.TOTALCHARGES,
S.CHURNVALUE

FROM DEMOGRAPHICS D LEFT OUTER JOIN 
SERVICES S ON S.CUSTOMERID = D.CUSTOMERID
 ;
 
 select * from train_dataset;
 